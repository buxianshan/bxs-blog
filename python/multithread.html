<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Python å¤šçº¿ç¨‹ | bxs.ink</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="https://buxianshan.oss-cn-beijing.aliyuncs.com/favicon.ico?versionId=CAEQMhiBgID7jPeK_BciIGUwMGYzZWJmMzM3NTQ4NDI5N2FhZDk3NDRiZjYzNjFl">
    <script>var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?40291c62c61f1ce49b021bc0f36df71e";
            if (window.location.hostname !== "localhost") {
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            }
        })();</script>
    <meta name="description" content="ä¸€äº›ä¸ªäººç†è§£ã€ç¬”è®°å’Œåˆ†äº«">
    
    <link rel="preload" href="/bxs-blog/assets/css/0.styles.a2c13d1a.css" as="style"><link rel="preload" href="/bxs-blog/assets/js/app.35a9b4f9.js" as="script"><link rel="preload" href="/bxs-blog/assets/js/2.e20f0717.js" as="script"><link rel="preload" href="/bxs-blog/assets/js/37.368055b8.js" as="script"><link rel="prefetch" href="/bxs-blog/assets/js/10.7d8fee8d.js"><link rel="prefetch" href="/bxs-blog/assets/js/11.a655d377.js"><link rel="prefetch" href="/bxs-blog/assets/js/12.4836946d.js"><link rel="prefetch" href="/bxs-blog/assets/js/13.315882db.js"><link rel="prefetch" href="/bxs-blog/assets/js/14.a631edd1.js"><link rel="prefetch" href="/bxs-blog/assets/js/15.3ccc3074.js"><link rel="prefetch" href="/bxs-blog/assets/js/16.3a0e5dcf.js"><link rel="prefetch" href="/bxs-blog/assets/js/17.6ab0507f.js"><link rel="prefetch" href="/bxs-blog/assets/js/18.f81b8706.js"><link rel="prefetch" href="/bxs-blog/assets/js/19.b7345b4d.js"><link rel="prefetch" href="/bxs-blog/assets/js/20.3bee7d2e.js"><link rel="prefetch" href="/bxs-blog/assets/js/21.f5759851.js"><link rel="prefetch" href="/bxs-blog/assets/js/22.37774dd8.js"><link rel="prefetch" href="/bxs-blog/assets/js/23.e9b13bfd.js"><link rel="prefetch" href="/bxs-blog/assets/js/24.c95554eb.js"><link rel="prefetch" href="/bxs-blog/assets/js/25.df6ecb5c.js"><link rel="prefetch" href="/bxs-blog/assets/js/26.dc500cce.js"><link rel="prefetch" href="/bxs-blog/assets/js/27.d298038e.js"><link rel="prefetch" href="/bxs-blog/assets/js/28.f77df000.js"><link rel="prefetch" href="/bxs-blog/assets/js/29.680717f1.js"><link rel="prefetch" href="/bxs-blog/assets/js/3.70bb5a13.js"><link rel="prefetch" href="/bxs-blog/assets/js/30.5e3a9398.js"><link rel="prefetch" href="/bxs-blog/assets/js/31.015ac383.js"><link rel="prefetch" href="/bxs-blog/assets/js/32.36704413.js"><link rel="prefetch" href="/bxs-blog/assets/js/33.8b8ef020.js"><link rel="prefetch" href="/bxs-blog/assets/js/34.bfe1e5e8.js"><link rel="prefetch" href="/bxs-blog/assets/js/35.8056453c.js"><link rel="prefetch" href="/bxs-blog/assets/js/36.e676ea3e.js"><link rel="prefetch" href="/bxs-blog/assets/js/38.0d4dfba9.js"><link rel="prefetch" href="/bxs-blog/assets/js/39.ec069c19.js"><link rel="prefetch" href="/bxs-blog/assets/js/4.c59397de.js"><link rel="prefetch" href="/bxs-blog/assets/js/40.59ee0d7e.js"><link rel="prefetch" href="/bxs-blog/assets/js/41.7d6eaf3a.js"><link rel="prefetch" href="/bxs-blog/assets/js/42.70003db2.js"><link rel="prefetch" href="/bxs-blog/assets/js/5.1416dedd.js"><link rel="prefetch" href="/bxs-blog/assets/js/6.da068902.js"><link rel="prefetch" href="/bxs-blog/assets/js/7.451e510b.js"><link rel="prefetch" href="/bxs-blog/assets/js/8.58f554d1.js"><link rel="prefetch" href="/bxs-blog/assets/js/9.b70ebacf.js">
    <link rel="stylesheet" href="/bxs-blog/assets/css/0.styles.a2c13d1a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/bxs-blog/" class="home-link router-link-active"><!----> <span class="site-name">bxs.ink</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/bxs-blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python Menu" class="dropdown-title"><span class="title">Python</span> <span class="arrow down"></span></button> <button type="button" aria-label="Python Menu" class="mobile-dropdown-title"><span class="title">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/bxs-blog/python/introduction.html" class="nav-link">
  ç®€ä»‹
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/python/snippets.html" class="nav-link">
  å¸¸ç”¨ä»£ç ç‰‡æ®µ
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/python/class.html" class="nav-link">
  Python é¢å‘å¯¹è±¡
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/python/multithread.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Python å¤šçº¿ç¨‹
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/python/build-package.html" class="nav-link">
  æ‰“åŒ…é¡¹ç›®åˆ°PyPI
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/python/pyc.html" class="nav-link">
  pycæ–‡ä»¶
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/python/name-style.html" class="nav-link">
  å‘½åé£æ ¼å»ºè®®
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/python/zen.html" class="nav-link">
  The Zen of Python
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java Menu" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java Menu" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/bxs-blog/java/basic.html" class="nav-link">
  JavaåŸºç¡€
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/java/jvm.html" class="nav-link">
  JVM
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Design Patterns Menu" class="dropdown-title"><span class="title">è®¾è®¡æ¨¡å¼</span> <span class="arrow down"></span></button> <button type="button" aria-label="Design Patterns Menu" class="mobile-dropdown-title"><span class="title">è®¾è®¡æ¨¡å¼</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/bxs-blog/design-patterns/introduction.html" class="nav-link">
  ç®€ä»‹
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/design-patterns/singleton.html" class="nav-link">
  å•ä¾‹æ¨¡å¼
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/design-patterns/visitor.html" class="nav-link">
  è®¿é—®è€…æ¨¡å¼
</a></li></ul></div></div><div class="nav-item"><a href="/bxs-blog/linux/commands-log.html" class="nav-link">
  Linux
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Front-end Menu" class="dropdown-title"><span class="title">å‰ç«¯</span> <span class="arrow down"></span></button> <button type="button" aria-label="Front-end Menu" class="mobile-dropdown-title"><span class="title">å‰ç«¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/bxs-blog/front-end/nodejs.html" class="nav-link">
  Node.js
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Docker" class="dropdown-title"><span class="title">Docker</span> <span class="arrow down"></span></button> <button type="button" aria-label="Docker" class="mobile-dropdown-title"><span class="title">Docker</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/bxs-blog/docker/notes.html" class="nav-link">
  åŸºç¡€ç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/docker/experience.html" class="nav-link">
  é—®é¢˜è®°å½•
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tools Menu" class="dropdown-title"><span class="title">å·¥å…·</span> <span class="arrow down"></span></button> <button type="button" aria-label="Tools Menu" class="mobile-dropdown-title"><span class="title">å·¥å…·</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/bxs-blog/tools/git.html" class="nav-link">
  Git
</a></li></ul></div></div><div class="nav-item"><a href="/bxs-blog/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="/bxs-blog/collections/" class="nav-link">
  æ”¶è—
</a></div><div class="nav-item"><a href="/bxs-blog/about/" class="nav-link">
  å…³äº
</a></div> <a href="https://github.com/buxianshan/bxs-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    æŸ¥çœ‹æºç 
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/bxs-blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python Menu" class="dropdown-title"><span class="title">Python</span> <span class="arrow down"></span></button> <button type="button" aria-label="Python Menu" class="mobile-dropdown-title"><span class="title">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/bxs-blog/python/introduction.html" class="nav-link">
  ç®€ä»‹
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/python/snippets.html" class="nav-link">
  å¸¸ç”¨ä»£ç ç‰‡æ®µ
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/python/class.html" class="nav-link">
  Python é¢å‘å¯¹è±¡
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/python/multithread.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Python å¤šçº¿ç¨‹
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/python/build-package.html" class="nav-link">
  æ‰“åŒ…é¡¹ç›®åˆ°PyPI
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/python/pyc.html" class="nav-link">
  pycæ–‡ä»¶
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/python/name-style.html" class="nav-link">
  å‘½åé£æ ¼å»ºè®®
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/python/zen.html" class="nav-link">
  The Zen of Python
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java Menu" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java Menu" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/bxs-blog/java/basic.html" class="nav-link">
  JavaåŸºç¡€
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/java/jvm.html" class="nav-link">
  JVM
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Design Patterns Menu" class="dropdown-title"><span class="title">è®¾è®¡æ¨¡å¼</span> <span class="arrow down"></span></button> <button type="button" aria-label="Design Patterns Menu" class="mobile-dropdown-title"><span class="title">è®¾è®¡æ¨¡å¼</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/bxs-blog/design-patterns/introduction.html" class="nav-link">
  ç®€ä»‹
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/design-patterns/singleton.html" class="nav-link">
  å•ä¾‹æ¨¡å¼
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/design-patterns/visitor.html" class="nav-link">
  è®¿é—®è€…æ¨¡å¼
</a></li></ul></div></div><div class="nav-item"><a href="/bxs-blog/linux/commands-log.html" class="nav-link">
  Linux
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Front-end Menu" class="dropdown-title"><span class="title">å‰ç«¯</span> <span class="arrow down"></span></button> <button type="button" aria-label="Front-end Menu" class="mobile-dropdown-title"><span class="title">å‰ç«¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/bxs-blog/front-end/nodejs.html" class="nav-link">
  Node.js
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Docker" class="dropdown-title"><span class="title">Docker</span> <span class="arrow down"></span></button> <button type="button" aria-label="Docker" class="mobile-dropdown-title"><span class="title">Docker</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/bxs-blog/docker/notes.html" class="nav-link">
  åŸºç¡€ç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/bxs-blog/docker/experience.html" class="nav-link">
  é—®é¢˜è®°å½•
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tools Menu" class="dropdown-title"><span class="title">å·¥å…·</span> <span class="arrow down"></span></button> <button type="button" aria-label="Tools Menu" class="mobile-dropdown-title"><span class="title">å·¥å…·</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/bxs-blog/tools/git.html" class="nav-link">
  Git
</a></li></ul></div></div><div class="nav-item"><a href="/bxs-blog/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="/bxs-blog/collections/" class="nav-link">
  æ”¶è—
</a></div><div class="nav-item"><a href="/bxs-blog/about/" class="nav-link">
  å…³äº
</a></div> <a href="https://github.com/buxianshan/bxs-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    æŸ¥çœ‹æºç 
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Python å¤šçº¿ç¨‹</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bxs-blog/python/multithread.html#threading-æ¨¡å—" class="sidebar-link">threading æ¨¡å—</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/bxs-blog/python/multithread.html#å¤šçº¿ç¨‹åŒæ­¥" class="sidebar-link">å¤šçº¿ç¨‹åŒæ­¥</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/bxs-blog/python/multithread.html#å®ˆæŠ¤çº¿ç¨‹" class="sidebar-link">å®ˆæŠ¤çº¿ç¨‹</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/bxs-blog/python/multithread.html#ä½¿ç”¨queueå®ç°çº¿ç¨‹æ± " class="sidebar-link">ä½¿ç”¨queueå®ç°çº¿ç¨‹æ± </a><ul class="sidebar-sub-headers"></ul></li><li><a href="/bxs-blog/python/multithread.html#ä½¿ç”¨threadpoolexecutor" class="sidebar-link">ä½¿ç”¨ThreadPoolExecutor</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 align="center">Python å¤šçº¿ç¨‹</h1> <p>å‚è€ƒï¼š</p> <ul><li><a href="https://docs.python.org/zh-cn/3/glossary.html#term-global-interpreter-lock" target="_blank" rel="noopener noreferrer">Global Interpreter Lock<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼šå…¨å±€è§£é‡Šå™¨é”</li> <li><a href="https://docs.python.org/zh-cn/3.9/library/threading.html#module-threading" target="_blank" rel="noopener noreferrer">threading<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼šPython å†…ç½®å¤šçº¿ç¨‹æ¨¡å—</li> <li><a href="https://docs.python.org/zh-cn/3.9/library/queue.html#module-queue" target="_blank" rel="noopener noreferrer">queue<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼šA multi-producer, multi-consumer queue</li> <li><a href="https://learnku.com/docs/pymotw/queue-thread-safe-fifo-queue/3370" target="_blank" rel="noopener noreferrer">queue â€” çº¿ç¨‹å®‰å…¨çš„ FIFO é˜Ÿåˆ—<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://learnku.com/docs/pymotw/threading-manage-concurrent-operations-within-a-process/3421" target="_blank" rel="noopener noreferrer">threading â€” ç®¡ç†å•ä¸ªè¿›ç¨‹é‡Œçš„å¹¶è¡Œæ“ä½œ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/6844903615824396295" target="_blank" rel="noopener noreferrer">åˆ—è¡¨ä¸é˜Ÿåˆ—â€”è°ˆè°ˆçº¿ç¨‹å®‰å…¨<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.51cto.com/u_6315133/3122185" target="_blank" rel="noopener noreferrer">ä¸ºä»€ä¹ˆPythonå¤šçº¿ç¨‹æ— æ³•åˆ©ç”¨å¤šæ ¸<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/6844904058533183495" target="_blank" rel="noopener noreferrer">Python çº¿ç¨‹æ± åŸç†åŠå®ç°<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://c.biancheng.net/view/2627.html" target="_blank" rel="noopener noreferrer">Python çº¿ç¨‹æ± åŠå…¶åŸç†å’Œä½¿ç”¨<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cloud.tencent.com/developer/article/1597890" target="_blank" rel="noopener noreferrer">ThreadPoolExecutor åˆ¤æ–­æ‰€æœ‰ä»»åŠ¡å·²ç»“æŸ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="threading-æ¨¡å—"><a href="#threading-æ¨¡å—" class="header-anchor">#</a> threading æ¨¡å—</h2> <p>ä½¿ç”¨çº¿ç¨‹çš„ä¸¤ç§æ–¹å¼ï¼š</p> <ul><li>åˆ›å»º<code>threading.Thread</code>çš„å¯¹è±¡æ‰§è¡ŒæŸä¸ªå‡½æ•°</li> <li>åˆ›å»º<code>threading.Thread</code>çš„å­ç±»ï¼Œé‡å†™runæ–¹æ³•</li></ul> <p>ä¾‹å­ï¼š</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> threading


<span class="token keyword">def</span> <span class="token function">task</span><span class="token punctuation">(</span>task_id<span class="token punctuation">,</span> task_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    å¤šçº¿ç¨‹è¦æ‰§è¡Œçš„ä»»åŠ¡
    :param task_id:
    :param task_name:
    :return:
    &quot;&quot;&quot;</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;task(id: </span><span class="token interpolation"><span class="token punctuation">{</span>task_id<span class="token punctuation">}</span></span><span class="token string">, name: </span><span class="token interpolation"><span class="token punctuation">{</span>task_name<span class="token punctuation">}</span></span><span class="token string">) done!&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># ä»¥argså…ƒç»„çš„å½¢å¼ä¼ å‚</span>
        t <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>task<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f&quot;t</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment"># ä»¥kwargså­—å…¸çš„å½¢å¼ä¼ å‚</span>
        <span class="token comment"># t = threading.Thread(target=task, kwargs={&quot;task_id&quot;: i, &quot;task_name&quot;: f&quot;t{i}&quot;})</span>
        t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>è¿™é‡Œé¡ºä¾¿è®°å½•ä¸€ä¸‹æˆ‘è‡ªå·±ä¹‹å‰ä¸€ç›´ä¸ç†è§£çš„åœ°æ–¹ï¼Œåˆ›å»ºçº¿ç¨‹çš„æ—¶å€™å¦‚ä½•ç»™è¦æ‰§è¡Œçš„å‡½æ•°ä¼ å‚å‘¢ï¼ˆå¤šä¸ªå‚æ•°ï¼‰ï¼Ÿ</p> <p>å…¶å®çœ‹ä¸€ä¸‹Threadæºç å°±å¾ˆæ¸…æ¥šäº†ï¼Œå¦‚å›¾ï¼š</p> <p><img src="https://buxianshan.oss-cn-beijing.aliyuncs.com/Typora_images/image-20220516201800404.png" alt="image-20220516201800404"></p> <p><code>Thread</code>çš„initæ–¹æ³•æä¾›äº†ä¸¤ç§å½¢å¼çš„å‚æ•°ï¼Œargsé»˜è®¤å€¼æ˜¯ä¸€ä¸ªç©ºå…ƒç»„ï¼Œkwargsé»˜è®¤å€¼æ˜¯Noneä½†æ˜¯å¸Œæœ›ä¼ çš„æ˜¯å­—å…¸ã€‚</p> <p>å†çœ‹ä¸€ä¸‹<code>run()</code>æ–¹æ³•æ˜¯å¦‚ä½•æŠŠå‚æ•°ä¼ ç»™æˆ‘ä»¬è¦æ‰§è¡Œçš„targetæ–¹æ³•çš„ï¼š</p> <p><img src="https://buxianshan.oss-cn-beijing.aliyuncs.com/Typora_images/image-20220516202123632.png" alt="image-20220516202123632"></p> <p>è¿™å°±å¾ˆæ¸…æ¥šäº†ï¼Œä¸€ä¸ªæ˜Ÿå·è§£åŒ…å…ƒç»„ï¼ˆæˆ–åˆ—è¡¨ç­‰ï¼‰ï¼Œä¸¤ä¸ªæ˜Ÿå·è§£åŒ…å­—å…¸ï¼Œæ‰€ä»¥ä¸ç®¡æ˜¯ä»¥å…ƒç»„çš„å½¢å¼å†™åˆ°argsé‡Œçš„å‚æ•°ï¼Œè¿˜æ˜¯ä»¥å­—å…¸å½¢å¼å†™åˆ°kwargsé‡Œçš„å‚æ•°ï¼Œéƒ½ä¼šè¢«è§£åŒ…åä¼ åˆ°targetæ–¹æ³•ã€‚</p> <h2 id="å¤šçº¿ç¨‹åŒæ­¥"><a href="#å¤šçº¿ç¨‹åŒæ­¥" class="header-anchor">#</a> å¤šçº¿ç¨‹åŒæ­¥</h2> <p>ä¸å¯é¿å…çš„è¦è€ƒè™‘çº¿ç¨‹åŒæ­¥ï¼Œè¿™æ˜¯ä¸€ä¸ªä¾‹å­ï¼šä½¿ç”¨countè¿›è¡Œå…¨å±€ä»»åŠ¡è®¡æ•°ï¼Œä¿®æ”¹countå€¼æ—¶éœ€è¦ä¿è¯çº¿ç¨‹åŒæ­¥ï¼Œé¿å…å†²çªã€‚</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> threading
<span class="token keyword">import</span> time
<span class="token keyword">import</span> random


total <span class="token operator">=</span> <span class="token number">100</span>
count <span class="token operator">=</span> <span class="token number">0</span>
lock <span class="token operator">=</span> threading<span class="token punctuation">.</span>Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    æ‰§è¡Œä¸€æ¬¡ä»»åŠ¡ï¼Œç»™countè®¡æ•°åŠ 1
    :return:
    &quot;&quot;&quot;</span>
    <span class="token keyword">global</span> total
    <span class="token keyword">global</span> count
    <span class="token comment"># éšæœº sleep 0åˆ°1ç§’ï¼Œæ¨¡æ‹Ÿä¸åŒä»»åŠ¡è€—æ—¶ä¸åŒ</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># è¿™é‡Œçº¿ç¨‹åŒæ­¥é”</span>
    <span class="token keyword">with</span> lock<span class="token punctuation">:</span>
        count <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;process: </span><span class="token interpolation"><span class="token punctuation">{</span>count<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{</span>total<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    thread_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        t <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>task<span class="token punctuation">)</span>
        thread_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>t<span class="token punctuation">)</span>

    <span class="token keyword">for</span> t <span class="token keyword">in</span> thread_list<span class="token punctuation">:</span>
        t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>ä½ å¯ä»¥å°è¯•æŠŠåŒæ­¥é”çš„ä»£ç æ³¨é‡Šæ‰ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</p> <p>åŠ é”çš„åœ°æ–¹ä¹Ÿå¯ä»¥ç”¨ä¸‹é¢è¿™ç§å†™æ³•ï¼š</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># è·å–é”</span>
lock<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token comment"># do something...</span>
    count <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;process: </span><span class="token interpolation"><span class="token punctuation">{</span>count<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{</span>total<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">finally</span><span class="token punctuation">:</span>
    <span class="token comment"># é‡Šæ”¾é”</span>
    lock<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="å®ˆæŠ¤çº¿ç¨‹"><a href="#å®ˆæŠ¤çº¿ç¨‹" class="header-anchor">#</a> å®ˆæŠ¤çº¿ç¨‹</h2> <p>å½“ç¨‹åºä¸­æ‹¥æœ‰å¤šä¸ªçº¿ç¨‹æ—¶ï¼Œä¸»çº¿ç¨‹æ‰§è¡Œç»“æŸå¹¶ä¸ä¼šå½±å“å­çº¿ç¨‹ç»§ç»­æ‰§è¡Œã€‚æ¢å¥è¯è¯´ï¼Œåªæœ‰ç¨‹åºä¸­æ‰€æœ‰çº¿ç¨‹å…¨éƒ¨æ‰§è¡Œå®Œæ¯•åï¼Œç¨‹åºæ‰ç®—çœŸæ­£ç»“æŸã€‚</p> <p>Python è¿˜æ”¯æŒåˆ›å»ºå¦ä¸€ç§çº¿ç¨‹ï¼Œç§°ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼ˆæˆ–åå°çº¿ç¨‹ï¼‰ã€‚æ­¤ç±»çº¿ç¨‹çš„ç‰¹ç‚¹æ˜¯ï¼Œå½“ç¨‹åºä¸­ä¸»çº¿ç¨‹åŠæ‰€æœ‰éå®ˆæŠ¤çº¿ç¨‹æ‰§è¡Œç»“æŸæ—¶ï¼Œæœªæ‰§è¡Œå®Œæ¯•çš„å®ˆæŠ¤çº¿ç¨‹ä¹Ÿä¼šéšä¹‹æ¶ˆäº¡ï¼ˆè¿›è¡Œæ­»äº¡çŠ¶æ€ï¼‰ï¼Œç¨‹åºå°†ç»“æŸè¿è¡Œã€‚</p> <p>ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœæŠŠ<code>t.daemon = True</code>æ³¨é‡Šæ‰ï¼Œåˆ™ç¨‹åºä¸€ç›´è¿è¡Œä¸é€€å‡ºã€‚</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> threading
<span class="token keyword">import</span> time


<span class="token keyword">def</span> <span class="token function">task</span><span class="token punctuation">(</span>task_id<span class="token punctuation">,</span> task_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;task(id: </span><span class="token interpolation"><span class="token punctuation">{</span>task_id<span class="token punctuation">}</span></span><span class="token string">, name: </span><span class="token interpolation"><span class="token punctuation">{</span>task_name<span class="token punctuation">}</span></span><span class="token string">) done!&quot;</span></span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        t <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>task<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f&quot;t</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment"># è®¾ä¸ºå®ˆæŠ¤çº¿ç¨‹</span>
        t<span class="token punctuation">.</span>daemon <span class="token operator">=</span> <span class="token boolean">True</span>
        t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="ä½¿ç”¨queueå®ç°çº¿ç¨‹æ± "><a href="#ä½¿ç”¨queueå®ç°çº¿ç¨‹æ± " class="header-anchor">#</a> ä½¿ç”¨queueå®ç°çº¿ç¨‹æ± </h2> <p>Pythonå®˜æ–¹æ–‡æ¡£çš„æè¿°ï¼šqueue æ¨¡å—å®ç°äº†å¤šç”Ÿäº§è€…ã€å¤šæ¶ˆè´¹è€…é˜Ÿåˆ—ã€‚è¿™ç‰¹åˆ«é€‚ç”¨äºæ¶ˆæ¯å¿…é¡»å®‰å…¨åœ°åœ¨å¤šçº¿ç¨‹é—´äº¤æ¢çš„çº¿ç¨‹ç¼–ç¨‹ã€‚</p> <p>é»˜è®¤çš„<code>queue.Queue</code>æ˜¯FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ã€‚</p> <p>ä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± ï¼Ÿ</p> <p>ä¼ ç»Ÿå¤šçº¿ç¨‹æ–¹æ¡ˆä¼šä½¿ç”¨â€œå³æ—¶åˆ›å»ºï¼Œ å³æ—¶é”€æ¯â€çš„ç­–ç•¥ã€‚è™½ç„¶ä¸åˆ›å»ºè¿›ç¨‹ç›¸æ¯”ï¼Œåˆ›å»ºçº¿ç¨‹çš„å¼€é”€å·²ç»å¾ˆå°ï¼Œä½†æ˜¯å¦‚æœæäº¤ç»™çº¿ç¨‹çš„ä»»åŠ¡æ‰§è¡Œæ—¶é—´è¾ƒçŸ­ï¼Œè€Œä¸”æ‰§è¡Œå¾ˆé¢‘ç¹ï¼Œé‚£ä¹ˆç³»ç»Ÿå°†å¤„äºä¸åœçš„åˆ›å»ºçº¿ç¨‹ï¼Œé”€æ¯çº¿ç¨‹çš„çŠ¶æ€ã€‚æ¯æ¬¡åˆ›å»ºéƒ½éœ€è¦ç»è¿‡å¯åŠ¨ã€é”€æ¯å’Œè¿è¡Œ3ä¸ªè¿‡ç¨‹ã€‚è¿™å¿…ç„¶ä¼šå¢åŠ ç³»ç»Ÿç›¸åº”çš„æ—¶é—´ï¼Œé™ä½äº†æ•ˆç‡ã€‚</p> <p>ä½¿ç”¨çº¿ç¨‹æ± ï¼šçº¿ç¨‹é¢„å…ˆè¢«åˆ›å»ºå¹¶æ”¾å…¥çº¿ç¨‹æ± ä¸­ï¼Œå¤„ç†å®Œå½“å‰ä»»åŠ¡ä¹‹åå¹¶ä¸é”€æ¯è€Œæ˜¯è¢«å®‰æ’å¤„ç†ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œå› æ­¤èƒ½å¤Ÿé¿å…å¤šæ¬¡åˆ›å»ºçº¿ç¨‹ï¼Œä»è€ŒèŠ‚çœçº¿ç¨‹åˆ›å»ºå’Œé”€æ¯çš„å¼€é”€ï¼Œèƒ½å¸¦æ¥æ›´å¥½çš„æ€§èƒ½å’Œç³»ç»Ÿç¨³å®šæ€§ã€‚</p> <p>ä½¿ç”¨queueå®ç°çº¿ç¨‹æ± çš„ä¾‹å­ï¼š</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> queue <span class="token keyword">import</span> Queue
<span class="token keyword">import</span> threading
<span class="token keyword">import</span> time


<span class="token comment"># åˆ›å»ºé˜Ÿåˆ—, ç”¨äºå­˜å‚¨ä»»åŠ¡</span>
queue <span class="token operator">=</span> Queue<span class="token punctuation">(</span><span class="token punctuation">)</span>
lock <span class="token operator">=</span> threading<span class="token punctuation">.</span>Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> queue<span class="token punctuation">.</span>empty<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># å¦‚æœä»»åŠ¡é˜Ÿåˆ—å·²ç»ä¸ºç©ºï¼Œåˆ™ä¼‘çœ 1ç§’</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            i <span class="token operator">=</span> queue<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">with</span> lock<span class="token punctuation">:</span>
                <span class="token comment"># do something...</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;thread-</span><span class="token interpolation"><span class="token punctuation">{</span>threading<span class="token punctuation">.</span>current_thread<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">: execute task </span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            queue<span class="token punctuation">.</span>task_done<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment"># åˆ›å»ºåŒ…æ‹¬3ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± </span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        t <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>task<span class="token punctuation">)</span>
        <span class="token comment"># è®¾ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œå½“ä¸»çº¿ç¨‹é€€å‡ºå¹¶ä¸”åªå‰©ä¸‹å®ˆæŠ¤çº¿ç¨‹æ—¶ï¼Œåˆ™é€€å‡ºç¨‹åº</span>
        t<span class="token punctuation">.</span>daemon <span class="token operator">=</span> <span class="token boolean">True</span>
        t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># å¾€ä»»åŠ¡é˜Ÿåˆ—æ·»åŠ 10ä¸ªä»»åŠ¡</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        queue<span class="token punctuation">.</span>put<span class="token punctuation">(</span>i<span class="token punctuation">)</span>

    <span class="token comment"># ç­‰å¾…é˜Ÿåˆ—æ‰€æœ‰å…ƒç´ è¢«å–é™¤</span>
    queue<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>è¾“å‡ºï¼š</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>thread-Thread-1: execute task 0
thread-Thread-1: execute task 1
thread-Thread-2: execute task 2
thread-Thread-1: execute task 3
thread-Thread-3: execute task 4
thread-Thread-3: execute task 7
thread-Thread-3: execute task 8
thread-Thread-3: execute task 9
thread-Thread-2: execute task 5
thread-Thread-1: execute task 6
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>å¯ä»¥çœ‹åˆ°è‡ªå§‹è‡³ç»ˆåªæœ‰3ä¸ªæ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ï¼Œ10ä¸ªä»»åŠ¡ä¸­æ¯ä¸ªä»»åŠ¡ç”±å“ªä¸ªçº¿ç¨‹æ‰§è¡Œæ˜¯ä¸å¯é¢„æµ‹çš„ï¼Œå“ªä¸ªçº¿ç¨‹å…ˆå–å‡ºä»»åŠ¡å°±ç”±å“ªä¸ªçº¿ç¨‹æ‰§è¡Œã€‚</p> <p>é¡ºä¾¿è®°å½•ä¸€äº›æ³¨æ„ç‚¹ï¼š</p> <ul><li>å½“é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œå¦‚æœç›´æ¥ä½¿ç”¨<code>queue.get()</code>åˆ™ä¼šé˜»å¡ï¼ˆä¸ä¼šæŠ›å¼‚å¸¸ï¼‰ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸­æœ‰å…ƒç´ ã€‚çœ‹æ–‡æ¡£çš„æ„æ€æ˜¯ï¼Œå¦‚æœæ²¡ç”¨blockæ˜¯é»˜è®¤å€¼Trueå¹¶ä¸”æ²¡ç”¨è®¾ç½®timeoutï¼Œé˜Ÿåˆ—ä¸ºç©ºæ—¶å°±ä¼šæ— é™ç­‰å¾…ğŸ˜‚ã€‚æƒ³è¦é¿å…è¿™ç§æƒ…å†µä¹Ÿå¾ˆç®€å•ï¼ŒæŠŠblockè®¾ä¸ºFalseï¼Œåˆ™é˜Ÿåˆ—ä¸ºç©ºæ—¶ä¼šæŠ›å¼‚å¸¸ã€‚</li></ul> <p><img src="https://buxianshan.oss-cn-beijing.aliyuncs.com/Typora_images/image-20220517195718011.png" alt="image-20220517195718011"></p> <ul><li>python3ä¸­çš„printæ–¹æ³•åˆ°åº•æ˜¯ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„æˆ‘ä¹Ÿä¸æ¸…æ¥šï¼Œå®æµ‹æ¥çœ‹ï¼Œæ²¡æœ‰åŠ é”æ—¶ï¼Œå¤šçº¿ç¨‹printæœ‰æ¦‚ç‡æ ¼å¼é”™ä¹±ï¼ˆè¯¥æ¢è¡Œçš„æ²¡æ¢è¡Œï¼‰ï¼ŒåŠ äº†é”ä¹‹åå®Œå…¨æ­£å¸¸äº†ï¼Œæ‰€ä»¥ä¾‹å­ä¸­çš„printè¿˜æ˜¯åŠ äº†é”ã€‚</li></ul> <h2 id="ä½¿ç”¨threadpoolexecutor"><a href="#ä½¿ç”¨threadpoolexecutor" class="header-anchor">#</a> ä½¿ç”¨ThreadPoolExecutor</h2> <p>çº¿ç¨‹æ± çš„åŸºç±»æ˜¯ concurrent.futures æ¨¡å—ä¸­çš„ Executorï¼ŒExecutor æä¾›äº†ä¸¤ä¸ªå­ç±»ï¼Œå³ ThreadPoolExecutor å’Œ ProcessPoolExecutorï¼Œå…¶ä¸­ ThreadPoolExecutor ç”¨äºåˆ›å»ºçº¿ç¨‹æ± ï¼Œè€Œ ProcessPoolExecutor ç”¨äºåˆ›å»ºè¿›ç¨‹æ± ã€‚</p> <p>ç¨‹åºå°† task å‡½æ•°æäº¤ï¼ˆsubmitï¼‰ç»™çº¿ç¨‹æ± åï¼Œsubmit æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª Future å¯¹è±¡ï¼ŒFuture ç±»ä¸»è¦ç”¨äºè·å–çº¿ç¨‹ä»»åŠ¡å‡½æ•°çš„è¿”å›å€¼ã€‚ç”±äºçº¿ç¨‹ä»»åŠ¡ä¼šåœ¨æ–°çº¿ç¨‹ä¸­ä»¥å¼‚æ­¥æ–¹å¼æ‰§è¡Œï¼Œå› æ­¤ï¼Œçº¿ç¨‹æ‰§è¡Œçš„å‡½æ•°ç›¸å½“äºä¸€ä¸ªâ€œå°†æ¥å®Œæˆâ€çš„ä»»åŠ¡ï¼Œæ‰€ä»¥ Python ä½¿ç”¨ Future æ¥ä»£è¡¨ã€‚</p> <p>çœ‹è¿™ä¸ªä¾‹å­ï¼š</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor<span class="token punctuation">,</span> wait<span class="token punctuation">,</span> ALL_COMPLETED
<span class="token keyword">import</span> threading
<span class="token keyword">import</span> time


<span class="token keyword">def</span> <span class="token function">task</span><span class="token punctuation">(</span>task_id<span class="token punctuation">)</span><span class="token punctuation">:</span>
    msg <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>threading<span class="token punctuation">.</span>current_thread<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> executed (task id: </span><span class="token interpolation"><span class="token punctuation">{</span>task_id<span class="token punctuation">}</span></span><span class="token string">)&quot;</span></span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> msg


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment"># åˆ›å»ºä¸€ä¸ªåŒ…å«3ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± </span>
    pool <span class="token operator">=</span> ThreadPoolExecutor<span class="token punctuation">(</span>max_workers<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token comment"># Futureå¯¹è±¡åˆ—è¡¨</span>
    future_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment"># å‘çº¿ç¨‹æ± æäº¤10ä¸ªä»»åŠ¡</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        future <span class="token operator">=</span> pool<span class="token punctuation">.</span>submit<span class="token punctuation">(</span>task<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
        future_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>future<span class="token punctuation">)</span>

    <span class="token comment"># ç­‰å¾…æ‰€æœ‰ä»»åŠ¡ç»“æŸ(timeout 10ç§’)</span>
    wait<span class="token punctuation">(</span>future_list<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> ALL_COMPLETED<span class="token punctuation">)</span>

    <span class="token comment"># è·å–æ‰€æœ‰ä»»åŠ¡è¿”å›å€¼</span>
    <span class="token keyword">for</span> future <span class="token keyword">in</span> future_list<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>future<span class="token punctuation">.</span>result<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># å…³é—­çº¿ç¨‹æ± </span>
    pool<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>è¾“å‡ºï¼š</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ThreadPoolExecutor-0_0 executed (task id: 0)
ThreadPoolExecutor-0_1 executed (task id: 1)
ThreadPoolExecutor-0_2 executed (task id: 2)
ThreadPoolExecutor-0_2 executed (task id: 3)
ThreadPoolExecutor-0_0 executed (task id: 4)
ThreadPoolExecutor-0_1 executed (task id: 5)
ThreadPoolExecutor-0_2 executed (task id: 6)
ThreadPoolExecutor-0_1 executed (task id: 7)
ThreadPoolExecutor-0_0 executed (task id: 8)
ThreadPoolExecutor-0_2 executed (task id: 9)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>ä¸ä¸Šé¢â€ä½¿ç”¨<code>queue</code>å’Œ<code>threading.Thread</code>å®ç°çº¿ç¨‹æ± â€œç›¸æ¯”ï¼ŒThreadPoolExecutorçš„ä¼˜ç‚¹ï¼š</p> <ul><li>å¯ä»¥è·å–ä»»åŠ¡çš„è¿”å›å€¼</li> <li>å¯ä»¥ç»™æäº¤ä¸åŒçš„ä»»åŠ¡ç»™çº¿ç¨‹æ± æ‰§è¡Œ</li> <li>ä¸éœ€è¦è‡ªå·±åˆ›å»ºå’Œç»´æŠ¤ä»»åŠ¡é˜Ÿåˆ—ï¼Œåªéœ€<code>submit</code>åæœ‰ç©ºé—²çº¿ç¨‹å°±ç«‹å³æ‰§è¡Œ</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/buxianshan/bxs-blog/edit/master/docs/python/multithread.md" target="_blank" rel="noopener noreferrer">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2022-05-18 10:18:37</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/bxs-blog/assets/js/app.35a9b4f9.js" defer></script><script src="/bxs-blog/assets/js/2.e20f0717.js" defer></script><script src="/bxs-blog/assets/js/37.368055b8.js" defer></script>
  </body>
</html>
